# Keyless Cars Security - CPS and IoT Security

## Physical Keys
- Initially, cars used ignition systems that required turning a physical key.
- The key would send a signal to start the ignition system and ignite the fuel vapor.
- This system had a significant flaw: an attacker with physical access to the car could replicate the signal.

## From Physical to Cyber Keys
- The immobilizer was the first solution to incorporate a cyber-component.
- It featured a small chip embedded in the car key.
- When inserted into the ignition, the chip emitted a unique code, which the car’s antenna received.
- If the code matched the car’s expected code, the ignition would start.

## Immobilizer
![[Pasted image 20251009133243.png]]

## Immobilizer Flaws
- Immobilizers prevent hotwiring and lockpicking, but they transmit the same code each time.
- An attacker could use eavesdropping equipment to record the code and later replay it to steal the car.
- This flaw was easily exploited using devices called code grabbers.

![[Pasted image 20251009133549.png]]

## Digital Signature Transponder
- Some car brands (Ford, Toyota, Nissan) use Digital Signature Transponders (DSTs).
- The DST is an RFID chip that uses encryption and a 40-bit secret key to secure communication.
- The car and the DST share a copy of the private key, ensuring secure communication.
![[Pasted image 20251009133842.png]]

![[Pasted image 20251009133927.png]]

## Cloning Attack
- The DST system prevents simple replay attacks, but the 40-bit key length is vulnerable.
- An attacker can record a challenge and response from the car, then try all possible key combinations.
- With FPGA hardware, this attack can be completed in a few hours, gaining access to the car.

## DST+ - Improved Solution
- DST+ improves DST by adding a Mutual Authentication Key (MAK).
- Both the car and DST+ share a key (K) and MAK for better security.
- If the challenge is incorrect, the DST+ will not respond, preventing replay attacks.

![[Pasted image 20251009134642.png]]

## Further Protection Measures - PKES
- Passive Keyless Entry Systems (PKES) work without user interaction.
- PKES uses RFID to check if the key is inside, outside, or near the car.
- The car starts the engine only if the key is within close proximity (inside the car).

## Different Threat Model
- In this model, the attacker does not have direct access to the key.
- Relay attacks exploit wireless communications between the key and the car, bypassing the challenge-response protocol.

## Relaying Signals
- A relay attack involves a man-in-the-middle attack, where a non-legitimate device relays communication between the key and car.
- The attacker does not need to modify or interpret the signals, just amplify and retransmit them.

![[Pasted image 20251009135053.png]]

## Advantage of Relay
- In a relay attack, the attacker only manipulates the physical layer by demodulating and amplifying signals.
- The delay introduced must be within the range accepted by the car's system to be effective.

## Relay over Cable
- The attack uses two loop antennas connected via a cable to relay low-frequency signals.
- This method is basic and may raise suspicion due to the visible cable.

![[Pasted image 20251009135613.png]]

## Relay over the Air
- To avoid detection, the cable is replaced by a wireless relay system.
- The emitter captures the low-frequency signal, upconverts it, amplifies it, and transmits it over the air. The receiver downconverts and amplifies it again.

![[Pasted image 20251009135814.png]]
## Results
- Successful relay attacks can unlock and start a car by relaying signals between the car's key and the vehicle.
- This type of attack exploits vulnerabilities in the car's wireless communication protocol.

![[Pasted image 20251009135912.png]]

## Possible Countermeasure: Distance Bounding
- Distance bounding protocols measure the physical distance between two entities.
- Using rapid exchanges of messages, distance can be estimated by measuring the communication round trip time.
- This prevents relay attacks by ensuring the key and car are within a valid proximity.

## Remote Keyless Entry and Start (RKE)
- RKE systems enable locking/unlocking and starting the car remotely using radio frequencies (315 MHz, 433 MHz, or 868 MHz).
- Earlier RKE systems did not use encryption, making them vulnerable to replay attacks.
